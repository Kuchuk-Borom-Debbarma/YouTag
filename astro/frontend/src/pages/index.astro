---
import Navbar from "../components/Navbar.astro"
import VideoCard from "../components/VideoCard.astro"
import type Video from '../models/Video'
import type User from '../models/User'

// Dummy User for Navbar
const dummyUser: User = {
    name: 'john doe',
    email: 'john@example.com',
    thumbnailUrl: 'www.image.com'
}

const dummyVideos: Video[] = [
    {
        videoId: "yt001",
        title: "Web Development Crash Course 2024",
        description: "Comprehensive guide to becoming a full-stack web developer in 2024. Learn the latest technologies and best practices.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Web+Dev+Course",
        tags: new Set(["Web Development", "Programming", "Tutorial"]),
    },
    {
        videoId: "yt002",
        title: "React Hooks Ultimate Guide",
        description: "Master React Hooks with practical examples and in-depth explanations. From useState to useContext and beyond!",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=React+Hooks",
        tags: new Set(["React", "JavaScript", "Frontend"]),
    },
    {
        videoId: "yt003",
        title: "Machine Learning for Beginners",
        description: "Start your AI journey with this beginner-friendly machine learning tutorial. Learn core concepts and practical applications.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Machine+Learning",
        tags: new Set(["Machine Learning", "AI", "Data Science"]),
    },
    {
        videoId: "yt004",
        title: "Python Automation Masterclass",
        description: "Learn how to automate boring tasks with Python. From simple scripts to complex workflows, this course covers it all.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Python+Automation",
        tags: new Set(["Python", "Automation", "Programming"]),
    },
    {
        videoId: "yt005",
        title: "Design Thinking Workshop",
        description: "Unlock your creative problem-solving skills with this comprehensive design thinking workshop for professionals.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Design+Thinking",
        tags: new Set(["Design", "Innovation", "UX"]),
    },
    {
        videoId: "yt006",
        title: "Cybersecurity Essentials",
        description: "Protect yourself and your organization with this comprehensive cybersecurity course covering latest threats and defenses.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Cybersecurity",
        tags: new Set(["Cybersecurity", "IT", "Technology"]),
    },
    {
        videoId: "yt007",
        title: "Blockchain and Cryptocurrency Explained",
        description: "Deep dive into blockchain technology, cryptocurrencies, and their potential to revolutionize finance and beyond.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Blockchain+Crypto",
        tags: new Set(["Blockchain", "Cryptocurrency", "Finance"]),
    },
    {
        videoId: "yt008",
        title: "Cloud Computing Fundamentals",
        description: "Comprehensive guide to cloud computing, covering AWS, Azure, and Google Cloud platforms with practical examples.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Cloud+Computing",
        tags: new Set(["Cloud", "DevOps", "Infrastructure"]),
    },
    {
        videoId: "yt009",
        title: "Mobile App Development with Flutter",
        description: "Learn to build cross-platform mobile applications using Flutter and Dart. Create beautiful, performant apps for iOS and Android.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Flutter+Development",
        tags: new Set(["Flutter", "Mobile Development", "Cross-Platform"]),
    },
    {
        videoId: "yt010",
        title: "Data Visualization Techniques",
        description: "Master the art of data visualization using tools like D3.js, Matplotlib, and Tableau. Transform raw data into compelling stories.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Data+Visualization",
        tags: new Set(["Data Science", "Visualization", "Analytics"]),
    },
    {
        videoId: "yt011",
        title: "Advanced SQL Mastery",
        description: "Take your database skills to the next level. Learn advanced SQL techniques, query optimization, and database design principles.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Advanced+SQL",
        tags: new Set(["SQL", "Database", "Backend"]),
    },
    {
        videoId: "yt012",
        title: "Ethical Hacking and Penetration Testing",
        description: "Learn the techniques used by ethical hackers to identify and fix vulnerabilities in computer systems and networks.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Ethical+Hacking",
        tags: new Set(["Cybersecurity", "Hacking", "Network Security"]),
    },
    {
        videoId: "yt013",
        title: "DevOps and Continuous Integration",
        description: "Comprehensive course on DevOps practices, CI/CD pipelines, Docker, Kubernetes, and modern software deployment strategies.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=DevOps+CI%2FCD",
        tags: new Set(["DevOps", "CI/CD", "Software Engineering"]),
    },
    {
        videoId: "yt014",
        title: "Natural Language Processing with Python",
        description: "Dive into the world of NLP. Learn text analysis, sentiment detection, and building intelligent language processing applications.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=NLP+Python",
        tags: new Set(["NLP", "Python", "Machine Learning"]),
    },
    {
        videoId: "yt015",
        title: "Responsive Web Design Masterclass",
        description: "Create stunning, mobile-friendly websites using modern CSS techniques, Flexbox, Grid, and responsive design principles.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Responsive+Design",
        tags: new Set(["Web Design", "CSS", "Frontend"]),
    },
    {
        videoId: "yt016",
        title: "Game Development with Unity",
        description: "Learn to create professional video games using Unity game engine. Cover 2D and 3D game development techniques.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Unity+Game+Dev",
        tags: new Set(["Game Development", "Unity", "Programming"]),
    },
    {
        videoId: "yt017",
        title: "Artificial Intelligence Ethics",
        description: "Explore the ethical implications of AI technologies, discussing bias, privacy, and the societal impact of intelligent systems.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=AI+Ethics",
        tags: new Set(["AI", "Ethics", "Technology"]),
    },
    {
        videoId: "yt018",
        title: "Serverless Computing Fundamentals",
        description: "Understand serverless architecture, AWS Lambda, Azure Functions, and how to build scalable applications without managing servers.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Serverless+Computing",
        tags: new Set(["Serverless", "Cloud", "Backend"]),
    },
    {
        videoId: "yt019",
        title: "GraphQL API Development",
        description: "Master GraphQL for building flexible and efficient APIs. Learn schema design, resolvers, and best practices.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=GraphQL+APIs",
        tags: new Set(["GraphQL", "API", "Web Development"]),
    },
    {
        videoId: "yt020",
        title: "Quantum Computing Basics",
        description: "Introduction to quantum computing concepts, quantum algorithms, and the potential future of computational technology.",
        thumbnailUrl: "https://via.placeholder.com/640x360.png?text=Quantum+Computing",
        tags: new Set(["Quantum Computing", "Technology", "Advanced Science"]),
    }
]


const userTags : string[] = [
    "Web development",
    "Tutorial",
    "GitHub",
    "Programming",
    "Frontend",
    "Backend",
    "Machine Learning",
    "Data Science",
    "Cybersecurity",
    "Cloud Computing",
    "DevOps",
    "Mobile Development",
    "Artificial Intelligence",
    "Blockchain",
    "UX Design",
    "Software Engineering",
    "Network Security",
    "Database Management",
    "Game Development",
    "Quantum Computing"
]

// Pagination setup
const page = Number(Astro.url.searchParams.get('page') || 1)
const videosPerPage = 6
const startIndex = (page - 1) * videosPerPage
const endIndex = startIndex + videosPerPage
const paginatedVideos = dummyVideos.slice(startIndex, endIndex)
const totalPages = Math.ceil(dummyVideos.length / videosPerPage)

// Tag Pagination setup
const tagPage = Number(Astro.url.searchParams.get('tagPage') || 1)
const tagsPerPage = 8
const startTagIndex = (tagPage - 1) * tagsPerPage
const endTagIndex = startTagIndex + tagsPerPage
const paginatedTags = userTags.slice(startTagIndex, endTagIndex)
const totalTagPages = Math.ceil(userTags.length / tagsPerPage)
---

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YOUTAG | Your Video Platform</title>
    <style>
        body {
            background-color: #0f0f0f;
            color: white;
            font-family: 'Arial', sans-serif;
        }
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
            padding: 1rem;
            max-width: 1400px;
            margin: 0 auto;
        }
        .tag-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 1rem;
            padding: 1rem;
            max-width: 1400px;
            margin: 0 auto;
        }
        .tag-chip {
            background-color: #333;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            text-align: center;
            transition: background-color 0.3s;
            cursor: pointer;
        }
        .tag-chip:hover {
            background-color: #555;
        }
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 2rem;
            gap: 0.5rem;
        }
        .pagination-btn {
            background-color: #333;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .pagination-btn:hover {
            background-color: #555;
        }
        .pagination-btn.active {
            background-color: #ff0000;
        }
        @media (max-width: 768px) {
            .video-grid, .tag-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 0.5rem;
            }
        }
    </style>
</head>
<body>
<Navbar user={dummyUser}/>

<main>
    <h2 style="text-align: center; margin-top: 1rem;">All Tags</h2>
    <div class="tag-grid">
        {paginatedTags.map(tag => (
                <div class="tag-chip">{tag}</div>
        ))}
    </div>

    <div class="pagination">
        {tagPage > 1 && (
                <a href={`?tagPage=${tagPage - 1}`} class="pagination-btn">
                    Previous
                </a>
        )}

        {Array.from({ length: totalTagPages }, (_, i) => i + 1).map(pageNum => (
                <a
                        href={`?tagPage=${pageNum}`}
                        class={`pagination-btn ${pageNum === tagPage ? 'active' : ''}`}
                >
                    {pageNum}
                </a>
        ))}

        {tagPage < totalTagPages && (
                <a href={`?tagPage=${tagPage + 1}`} class="pagination-btn">
                    Next
                </a>
        )}
    </div>

    <h2 style="text-align: center; margin-top: 2rem;">Videos</h2>
    <div class="video-grid">
        {paginatedVideos.map(video => (
                <VideoCard video={video} />
        ))}
    </div>

    <div class="pagination">
        {page > 1 && (
                <a href={`?page=${page - 1}`} class="pagination-btn">
                    Previous
                </a>
        )}

        {Array.from({ length: totalPages }, (_, i) => i + 1).map(pageNum => (
                <a
                        href={`?page=${pageNum}`}
                        class={`pagination-btn ${pageNum === page ? 'active' : ''}`}
                >
                    {pageNum}
                </a>
        ))}

        {page < totalPages && (
                <a href={`?page=${page + 1}`} class="pagination-btn">
                    Next
                </a>
        )}
    </div>
</main>
</body>
</html>